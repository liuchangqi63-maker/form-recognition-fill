# Smart Table Assistant - 设计文档

## 应用概述

智能表格助手是一款移动应用，帮助用户将图片中的表格转换为可编辑的在线文档，并通过 AI 能力实现智能搜索填充和自然语言编辑。

## 屏幕列表

### 1. 首页 (Home Screen)
- **主要功能**: 显示用户的表格文档列表，提供新建入口
- **内容**: 
  - 顶部标题栏
  - 文档卡片列表（显示文档名称、创建时间、预览缩略图）
  - 底部浮动按钮：新建文档

### 2. 新建文档页 (Create Document Screen)
- **主要功能**: 选择创建方式
- **内容**:
  - 从图片识别表格（拍照/相册）
  - 创建空白表格
  - 输入表格主题和描述

### 3. 表格编辑页 (Table Editor Screen)
- **主要功能**: 核心编辑界面
- **内容**:
  - 顶部工具栏（保存、分享、更多操作）
  - 表格视图（可滚动、可编辑单元格）
  - 底部 AI 输入栏（用于发送指令）
  - AI 操作按钮（搜索填充、修改内容）

### 4. AI 对话页 (AI Chat Sheet)
- **主要功能**: 与 AI 交互的底部弹出面板
- **内容**:
  - 对话历史
  - 输入框
  - 快捷操作按钮（搜索网页、填充数据、修改内容）

## 主要内容和功能

### 首页
| 元素 | 说明 |
|------|------|
| 文档列表 | FlatList 展示所有表格文档 |
| 文档卡片 | 显示名称、更新时间、行列数 |
| 新建按钮 | 浮动操作按钮，打开新建流程 |
| 空状态 | 无文档时的引导提示 |

### 表格编辑器
| 元素 | 说明 |
|------|------|
| 表格网格 | 支持横向纵向滚动的表格视图 |
| 单元格 | 可点击编辑，支持选中状态 |
| 行列操作 | 添加/删除行列 |
| AI 输入栏 | 固定在底部的输入框 |

### AI 功能
| 功能 | 说明 |
|------|------|
| 图片识别 | 上传图片，AI 识别表格结构和内容 |
| 搜索填充 | 根据用户指令搜索网页并填充数据 |
| 内容修改 | 通过自然语言描述修改表格内容 |

## 关键用户流程

### 流程 1: 从图片创建表格
1. 用户点击首页"新建"按钮
2. 选择"从图片识别"
3. 拍照或从相册选择图片
4. 输入表格主题和说明（可选）
5. AI 识别并生成表格
6. 进入表格编辑页

### 流程 2: 使用 AI 搜索填充
1. 在表格编辑页，点击 AI 输入栏
2. 输入搜索指令，如"搜索2024年全球手机销量排行"
3. AI 搜索网页并展示结果预览
4. 用户确认后，数据填充到表格

### 流程 3: 自然语言修改表格
1. 在表格编辑页，点击 AI 输入栏
2. 输入修改指令，如"将第二列按数值从大到小排序"
3. AI 理解指令并执行修改
4. 表格实时更新

### 流程 4: 编辑和保存
1. 点击单元格直接编辑内容
2. 使用工具栏添加/删除行列
3. 自动保存或手动保存

## 配色方案

| 颜色 | 用途 | 值 |
|------|------|-----|
| Primary | 主色调、按钮、强调 | #2563EB (蓝色) |
| Background | 页面背景 | Light: #FFFFFF, Dark: #151718 |
| Surface | 卡片、表格背景 | Light: #F8FAFC, Dark: #1E2022 |
| Foreground | 主要文字 | Light: #11181C, Dark: #ECEDEE |
| Muted | 次要文字 | Light: #687076, Dark: #9BA1A6 |
| Border | 边框、分割线 | Light: #E2E8F0, Dark: #334155 |
| Success | 成功状态 | #22C55E |
| Error | 错误状态 | #EF4444 |

## 数据模型

### Document (文档)
```typescript
interface Document {
  id: string;
  title: string;
  description?: string;
  tableData: TableData;
  createdAt: Date;
  updatedAt: Date;
}
```

### TableData (表格数据)
```typescript
interface TableData {
  headers: string[];
  rows: string[][];
}
```

### AIMessage (AI 消息)
```typescript
interface AIMessage {
  id: string;
  role: 'user' | 'assistant';
  content: string;
  timestamp: Date;
}
```

## 技术要点

1. **图片识别**: 使用后端 LLM 的多模态能力识别图片中的表格
2. **表格渲染**: 使用 ScrollView 嵌套实现双向滚动
3. **AI 交互**: 通过 tRPC 调用后端 LLM API
4. **本地存储**: 使用 AsyncStorage 存储文档数据
5. **状态管理**: 使用 React Context + useState

## 交互设计

- 点击单元格：显示编辑模式
- 长按单元格：显示更多操作（复制、删除行/列）
- 下拉刷新：刷新文档列表
- AI 输入：支持回车发送，支持多行输入
- 加载状态：AI 处理时显示加载动画
